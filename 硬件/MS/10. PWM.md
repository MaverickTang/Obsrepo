# Pulse Width Modulation (PWM)

## Intro

### Defination

 PWM is a commonly used **control technique** that generates analog signals from digital devices such as microcontrollers.

In PWM technique, the signalâ€™s energy is distributed **through a series of pulses** rather than a continuously varying (analog) signal.

Pulse width modulation is an effective method that is used **to control the amount of power delivered to a load without dissipating any wasted power**.

In electronics, modulation is the process of varying one or more properties of a periodic waveform.

Pulse modulation is a type of modulation in which the signal is transmitted in the form of pulses.

PWMï¼ˆPulse Width Modulationï¼‰æ§åˆ¶â€”â€”è„‰å†²å®½åº¦è°ƒåˆ¶æŠ€æœ¯ï¼Œé€šè¿‡å¯¹ä¸€ç³»åˆ—**è„‰å†²çš„å®½åº¦**è¿›è¡Œè°ƒåˆ¶ï¼Œæ¥ç­‰æ•ˆåœ°è·å¾—æ‰€éœ€è¦æ³¢å½¢ï¼ˆå«å½¢çŠ¶å’Œå¹…å€¼ï¼‰.PWMæ§åˆ¶æŠ€æœ¯åœ¨é€†å˜ç”µè·¯ä¸­åº”ç”¨æœ€å¹¿ï¼Œåº”ç”¨çš„é€†å˜ç”µè·¯ç»å¤§éƒ¨åˆ†æ˜¯PWMå‹ï¼ŒPWMæ§åˆ¶æŠ€æœ¯æ­£æ˜¯æœ‰èµ–äºåœ¨é€†ã€€å˜ç”µè·¯ä¸­çš„åº”ç”¨ï¼Œæ‰ç¡®å®šäº†å®ƒåœ¨ç”µåŠ›ç”µå­æŠ€æœ¯ä¸­çš„é‡è¦åœ°ä½

The general purpose of Pulse Width Modulation is to control power delivery, especially to inertial electrical devices.

### ç›¸å…³æ¦‚å¿µ

By Controlling the Pulse width, we can control the voltage applied to LED and hence the brightness

PWM uses a rectangular pulse wave whose pulse width is modulated resulting in the variation of the average value of the waveform.

å ç©ºæ¯”

* Duty cycle = (T on /T) * 100 
  * â€œRatio of ON time to total time periodâ€

* If duty cycle is 50%, it means the pulse remain ON for 50% of the time.
* By changing the duty cycle, we control the average voltage applied to load and we can control different devices

* è¾“å‡ºçš„PWMä¸­ï¼Œ**é«˜ç”µå¹³ä¿æŒçš„æ—¶é—´ä¸è¯¥PWMçš„æ—¶é’Ÿå‘¨æœŸçš„æ—¶é—´ ä¹‹æ¯”**

* å¦‚ï¼Œä¸€ä¸ªPWMçš„é¢‘ç‡æ˜¯1000Hzï¼Œé‚£ä¹ˆå®ƒçš„æ—¶é’Ÿå‘¨æœŸå°±æ˜¯1msï¼Œå°±æ˜¯1000usï¼Œå¦‚æœé«˜ç”µå¹³å‡ºç°çš„æ—¶é—´æ˜¯200usï¼Œé‚£ä¹ˆä½ç”µå¹³çš„æ—¶é—´è‚¯å®šæ˜¯800usï¼Œé‚£ä¹ˆå ç©ºæ¯”å°±æ˜¯200:1000ï¼Œä¹Ÿå°±æ˜¯è¯´PWMçš„å ç©ºæ¯”å°±æ˜¯1:5ã€‚

Signal Average Value

* Average value of a pulse waveform f(t) with period T, low value VL, high value VH can be found as:

* Vavg =D*Vï¼ˆHighï¼‰+ï¼ˆ1-Dï¼‰Vï¼ˆLowï¼‰
* The average value of the signal is directly dependent on the duty cycle D
* 

åˆ†è¾¨ç‡

* **å ç©ºæ¯”æœ€å°èƒ½è¾¾åˆ°å¤šå°‘**ï¼Œå¦‚8ä½çš„PWMï¼Œç†è®ºçš„åˆ†è¾¨ç‡å°±æ˜¯1:255(å•æ–œç‡)ï¼Œ 16ä½çš„çš„PWMç†è®ºå°±æ˜¯1:65535(å•æ–œç‡)ã€‚

* é¢‘ç‡å°±æ˜¯è¿™æ ·çš„ï¼Œå¦‚16ä½çš„PWMï¼Œå®ƒçš„åˆ†è¾¨ç‡è¾¾åˆ°äº†1:65535ï¼Œè¦è¾¾åˆ°è¿™ä¸ªåˆ†è¾¨ç‡ï¼ŒT/Cå°±å¿…é¡»ä»0è®¡æ•°åˆ°65535æ‰èƒ½è¾¾åˆ°ï¼Œå¦‚æœè®¡æ•°ä»0è®¡åˆ°80ä¹‹ååˆä»0å¼€å§‹è®¡åˆ°80.......ï¼Œé‚£ä¹ˆå®ƒçš„åˆ†è¾¨ç‡æœ€å°å°±æ˜¯1:80äº†ï¼Œä½†æ˜¯ï¼Œå®ƒä¹Ÿå¿«äº†ï¼Œä¹Ÿå°±æ˜¯è¯´PWMçš„è¾“å‡ºé¢‘ç‡é«˜äº†ã€‚

åŒæ–œç‡ / å•æ–œç‡

* å‡è®¾ä¸€ä¸ªPWMä»0è®¡æ•°åˆ°80ï¼Œä¹‹ååˆä»0è®¡æ•°åˆ°80.......  è¿™ä¸ªå°±æ˜¯å•æ–œç‡ã€‚

* å‡è®¾ä¸€ä¸ªPWMä»0è®¡æ•°åˆ°80ï¼Œä¹‹åæ˜¯ä»80è®¡æ•°åˆ°0.......  è¿™ä¸ªå°±æ˜¯åŒæ–œç‡ã€‚

* åŒæ–œç‡çš„è®¡æ•°æ—¶é—´å¤šäº†ä¸€å€ï¼Œæ‰€ä»¥è¾“å‡ºçš„PWMé¢‘ç‡å°±æ…¢äº†ä¸€åŠï¼Œä½†æ˜¯åˆ†è¾¨ç‡å´æ˜¯1:(80+80) =1:160ï¼Œå°±æ˜¯æé«˜äº†ä¸€å€ã€‚

## Principle

### ç†è®ºåŸºç¡€
å†²é‡ç›¸ç­‰è€Œå½¢çŠ¶ä¸åŒçš„çª„è„‰å†²åŠ åœ¨å…·æœ‰æƒ¯æ€§çš„ç¯èŠ‚ä¸Šæ—¶ï¼Œå…¶æ•ˆæœåŸºæœ¬ç›¸åŒã€‚å†²é‡æŒ‡çª„è„‰å†²çš„é¢ç§¯ã€‚æ•ˆæœåŸºæœ¬ç›¸åŒï¼Œæ˜¯æŒ‡ç¯èŠ‚çš„è¾“å‡ºå“åº”æ³¢å½¢åŸºæœ¬ç›¸åŒã€‚ä½é¢‘æ®µéå¸¸æ¥è¿‘ï¼Œä»…åœ¨é«˜é¢‘æ®µç•¥æœ‰å·®å¼‚ã€‚
![img](http://www.elecfans.com/uploads/allimg/121102/1183908-12110210504L23.jpg)
                   å›¾1ã€€å½¢çŠ¶ä¸åŒè€Œå†²é‡ç›¸åŒçš„å„ç§çª„è„‰å†²
é¢ç§¯ç­‰æ•ˆåŸç†ï¼š

åˆ†åˆ«å°†å¦‚å›¾1æ‰€ç¤ºçš„ç”µå‹çª„è„‰å†²åŠ åœ¨ä¸€é˜¶æƒ¯æ€§ç¯èŠ‚ï¼ˆR-Lç”µè·¯ï¼‰ä¸Šï¼Œå¦‚å›¾2aæ‰€ç¤ºã€‚å…¶è¾“å‡ºç”µæµi(t)å¯¹ä¸åŒçª„è„‰å†²æ—¶çš„å“åº”æ³¢å½¢å¦‚å›¾2bæ‰€ç¤ºã€‚ä»æ³¢å½¢å¯ä»¥çœ‹å‡ºï¼Œåœ¨i(t)çš„ä¸Šå‡æ®µï¼Œi(t)çš„å½¢çŠ¶ä¹Ÿç•¥æœ‰ä¸åŒï¼Œä½†å…¶ä¸‹é™æ®µåˆ™å‡ ä¹å®Œå…¨ç›¸åŒã€‚è„‰å†²è¶Šçª„ï¼Œå„i(t)å“åº”æ³¢å½¢çš„å·®å¼‚ä¹Ÿè¶Šå°ã€‚å¦‚æœå‘¨æœŸæ€§åœ°æ–½åŠ ä¸Šè¿°è„‰å†²ï¼Œåˆ™å“åº”i(t)ä¹Ÿæ˜¯å‘¨æœŸæ€§çš„ã€‚ç”¨å‚…é‡Œå¶çº§æ•°åˆ†è§£åå°†å¯çœ‹å‡ºï¼Œå„i(t)åœ¨ä½é¢‘æ®µçš„ç‰¹æ€§å°†éå¸¸æ¥è¿‘ï¼Œä»…åœ¨é«˜é¢‘æ®µæœ‰æ‰€ä¸åŒã€‚
![img](http://www.elecfans.com/uploads/allimg/121102/1183908-12110210531Ea.jpg)







â€‹                 å›¾2 å†²é‡ç›¸åŒçš„å„ç§çª„è„‰å†²çš„å“åº”æ³¢å½¢
ç”¨ä¸€ç³»åˆ—ç­‰å¹…ä¸ç­‰å®½çš„è„‰å†²æ¥ä»£æ›¿ä¸€ä¸ªæ­£å¼¦åŠæ³¢ï¼Œæ­£å¼¦åŠæ³¢Nç­‰åˆ†ï¼Œçœ‹æˆNä¸ªç›¸è¿çš„è„‰å†²åºåˆ—ï¼Œå®½åº¦ç›¸ç­‰ï¼Œä½†å¹…å€¼ä¸ç­‰ï¼›ç”¨çŸ©å½¢è„‰å†²ä»£æ›¿ï¼Œç­‰å¹…ï¼Œä¸ç­‰å®½ï¼Œä¸­ç‚¹é‡åˆï¼Œé¢ç§¯ï¼ˆå†²é‡ï¼‰ç›¸ç­‰ï¼Œå®½åº¦æŒ‰æ­£å¼¦è§„å¾‹å˜åŒ–ã€‚SPWMæ³¢å½¢â€”â€”è„‰å†²å®½åº¦æŒ‰æ­£å¼¦è§„å¾‹å˜åŒ–è€Œå’Œæ­£å¼¦æ³¢ç­‰æ•ˆçš„PWMæ³¢å½¢ã€‚
![img](http://www.elecfans.com/uploads/allimg/121102/1183908-121102105506300.jpg)













â€‹                å›¾3 ç”¨PWMæ³¢ä»£æ›¿æ­£å¼¦åŠæ³¢
 

è¦æ”¹å˜ç­‰æ•ˆè¾“å‡ºæ­£å¼¦æ³¢å¹…å€¼ï¼ŒæŒ‰åŒä¸€æ¯”ä¾‹æ”¹å˜å„è„‰å†²å®½åº¦å³å¯ã€‚ PWMç”µæµæ³¢ï¼š ç”µæµå‹é€†å˜ç”µè·¯è¿›è¡ŒPWMæ§åˆ¶ï¼Œå¾—åˆ°çš„å°±æ˜¯PWMç”µæµæ³¢ã€‚ PWMæ³¢å½¢å¯ç­‰æ•ˆçš„å„ç§æ³¢å½¢ï¼š ç›´æµæ–©æ³¢ç”µè·¯ï¼šç­‰æ•ˆç›´æµæ³¢å½¢
SPWMæ³¢ï¼šç­‰æ•ˆæ­£å¼¦æ³¢å½¢ï¼Œè¿˜å¯ä»¥ç­‰æ•ˆæˆå…¶ä»–æ‰€éœ€æ³¢å½¢ï¼Œå¦‚ç­‰æ•ˆæ‰€éœ€éæ­£å¼¦äº¤æµæ³¢å½¢ç­‰ï¼Œå…¶åŸºæœ¬åŸç†å’ŒSPWMæ§åˆ¶ç›¸åŒï¼Œä¹ŸåŸºäºç­‰æ•ˆé¢ç§¯åŸç†ã€‚
æ¨¡æ‹Ÿä¿¡å·çš„å€¼å¯ä»¥è¿ç»­å˜åŒ–ï¼Œå…¶æ—¶é—´å’Œå¹…åº¦çš„åˆ†è¾¨ç‡éƒ½æ²¡æœ‰é™åˆ¶ã€‚9Vç”µæ± å°±æ˜¯ä¸€ç§æ¨¡æ‹Ÿå™¨ä»¶ï¼Œå› ä¸ºå®ƒçš„è¾“å‡ºç”µå‹å¹¶ä¸ç²¾ç¡®åœ°ç­‰äº9Vï¼Œè€Œæ˜¯éšæ—¶é—´å‘ç”Ÿå˜åŒ–ï¼Œå¹¶å¯å–ä»»ä½•å®æ•°å€¼ã€‚ä¸æ­¤ç±»ä¼¼ï¼Œä»ç”µæ± å¸æ”¶çš„ç”µæµä¹Ÿä¸é™å®šåœ¨ä¸€ç»„å¯èƒ½çš„å–å€¼èŒƒå›´ä¹‹å†…ã€‚æ¨¡æ‹Ÿä¿¡å·ä¸æ•°å­—ä¿¡å·çš„åŒºåˆ«åœ¨äºåè€…çš„å–å€¼é€šå¸¸åªèƒ½å±äºé¢„å…ˆç¡®å®šçš„å¯èƒ½å–å€¼é›†åˆä¹‹å†…ï¼Œä¾‹å¦‚åœ¨{0V, 5V}è¿™ä¸€é›†åˆä¸­å–å€¼ã€‚

### Generating of PWM

The simplest way of generating PWM is using a comparator circuit.

A voltage comparator considers two voltage waveforms A and B, and outputs a binary (two-valued) voltage waveform indicating which is larger (high voltage for ğ‘‰out states that A is larger and a low voltage that B is larger).

When the voltage of triangular wave is greater than the control voltage, the output of comparator will be high

When voltage of triangular wave is less than the control voltage, the output of comparator will be low

The width of the pulse can be changed depending on the value of the control voltage.

If we reduce the control voltage, the width of the output pulse increases

We can generate PWM from a digital output by switching it on and off, and changing the time for which the digital signal is â€œhighâ€ or â€œlowâ€, but that would take up the time and effort of the CPU.

- The advantage of handling over responsibility of the PWM signal generation to the specific peripheral in the microcontroller chip, is that the CPU is then available to do other stuff.
- This is one of the powerful aspects of a highly functionalised microcontroller â€“ devolving responsibility for things low PWM, D/A and A/D to the peripherals frees up the time of the CPU.



### Analog Geneation of PWM

The Intersective Method: 

Allows for analog creation of PWM signal through noting intersections between a **sawtooth trigger signal and a reference sinusoid**.

Length of pulses is dependent upon intersection of reference sinusoid and trigger signal.

When sinusoid is greater than trigger signal, PWM pulse is switched to on/high position, otherwise it is switched to off/low.

### Turning PWM back

The average value of the signal will be determined by the duty cycle

By controlling the duty cycle, we can control the average value 

If â€œonâ€ time is small, average value is low; if â€œonâ€ time is large,

average value is higher

The average value can be extracted from the PWM signal **with a low pass filter** â€“ then Vout is an analogue output

### 3 types of PWM

Lead Edge Modulation: 

* The leading edge of the signal is fixed and the **trailing edge is modulated** in accordance with instantaneous values of message signal.

Trail Edge Modulation

*  The trailing edge of the trigger signal is fixed and the **leading edge is modulated** in accordance with instantaneous values of message signal.

Pulse Center Two Edge Modulation

* The pulse center is fixed in the middle and **both edges are modulated** about the center of the trigger signal.





## Pros & Cons

Average value **proportional** to duty cycle

Low power used in transistors to switch the signal, and **fast switching possible** due to MOSFETS (metal-oxide-semiconductor field-effect transistor) and power transistors at speeds in excess of 100 kHz

To fulfill partial power requirements, variable resistance devices such as rheostats were used to control the current entering a device (e.g. sewing machines)

Alleviates the problem of high heat losses through resistive elements at intermediate voltage points

The main advantage of PWM is that power loss in digital switching devices (the FET) is very low.

When a switch is off there is practically no current leaking

- When it is on and power is being transferred to the load, there is almost no voltage drop across the switch
- Power loss, being the product of voltage and current, is thus in both cases close to zero