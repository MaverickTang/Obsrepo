# 远程库操作

## 配置远程库（以github为例）

git使用SSH配置， 初始需要以下三个步骤

* 使用秘钥生成工具生成rsa秘钥和公钥

* 将rsa公钥添加到代码托管平台
* 将rsa秘钥添加到ssh-agent中，为ssh client指定使用的秘钥文件
  
  

### 检查本地主机是否已经存在ssh key

````
cd ~/.ssh
ls
//看是否存在 id_rsa 和 id_rsa.pub文件，如果存在，说明已经有SSH Key
````

如果存在，直接跳到第三步

### 生成ssh key

如果不存在ssh key，使用如下命令生成

```
ssh-keygen -t rsa -C "xxx@xxx.com"
//执行后一直回车即可
```


生成完以后再用第二步命令，查看ssh key

### 获取ssh key公钥内容（id_rsa.pub）

````
cd ~/.ssh
cat id_rsa.pub
````


如下图所示，复制该内容

### Github账号上添加公钥

进入Settings设置

添加ssh key，把刚才复制的内容粘贴上去保存即可

### 验证是否设置成功

```
ssh -T git@github.com
```

## 添加远程库

先在github创建远程库，然后在本地进行操作

### `git remote add origin git@server-name:path/repo-name.git`关联远程库

在本地的`learngit`仓库下运行命令：

```
$ git remote add origin git@github.com:michaelliao/learngit.git
```

请千万注意，把上面的`michaelliao`替换成你自己的GitHub账户名，否则，你在本地关联的就是我的远程库，关联没有问题，但是你以后推送是推不上去的，因为你的SSH Key公钥不在我的账户列表中。

添加后，远程库的名字就是`origin`，这是Git默认的叫法，也可以改成别的，但是`origin`这个名字一看就知道是远程库。

### `git push -u origin master`第一次推送master分支的所有内容

把本地库的所有内容推送到远程库上：

```
$ git push -u origin master
Counting objects: 20, done.
Delta compression using up to 4 threads.
Compressing objects: 100% (15/15), done.
Writing objects: 100% (20/20), 1.64 KiB | 560.00 KiB/s, done.
Total 20 (delta 5), reused 0 (delta 0)
remote: Resolving deltas: 100% (5/5), done.
To github.com:michaelliao/learngit.git
 * [new branch]      master -> master
Branch 'master' set up to track remote branch 'master' from 'origin'.
```

把本地库的内容推送到远程，用`git push`命令，实际上是把当前分支`master`推送到远程。

由于远程库是空的，我们第一次推送`master`分支时，加上了`-u`参数，Git不但会把本地的`master`分支内容推送的远程新的`master`分支，还会把本地的`master`分支和远程的`master`分支关联起来，在以后的推送或者拉取时就可以简化命令。

**注意**：如果出现

````
error: src refspec master does not match any error: failed to push
````

则需要查看master分支是否创建，[传送门](https://www.freecodecamp.org/chinese/news/error-src-refspec-master-does-not-match-any-how-to-fix-in-git/)

### github实例

#### Create a new repository on the command line

```
echo "# test" >> README.md
git init
git add README.md
git commit -m "first commit"
git branch -M main
git remote add origin https://github.com/MaverickTang/test.git
git push -u origin main
```

#### Push an existing repository from the command line

```
git remote add origin https://github.com/MaverickTang/test.git
git branch -M main
git push -u origin main
```

### `git remote rm <name>`删除远程库

如果添加的时候地址写错了，或者就是想删除远程库，可以用`git remote rm <name>`命令。使用前，建议先用`git remote -v`查看远程库信息：

```
$ git remote -v
origin  git@github.com:michaelliao/learn-git.git (fetch)
origin  git@github.com:michaelliao/learn-git.git (push)
```

然后，根据名字删除，比如删除`origin`：

```
$ git remote rm origin
```

此处的“删除”其实是解除了本地和远程的绑定关系，并不是物理上删除了远程库。远程库本身并没有任何改动。要真正删除远程库，需要登录到GitHub，在后台页面找到删除按钮再删除。

### 小结

要关联一个远程库，使用命令`git remote add origin git@server-name:path/repo-name.git`；

关联一个远程库时必须给远程库指定一个名字，`origin`是默认习惯命名；

关联后，使用命令`git push -u origin master`第一次推送master分支的所有内容；

此后，每次本地提交后，只要有必要，就可以使用命令`git push origin master`推送最新修改；

`git pull`同步本地与远程库

分布式版本系统的最大好处之一是在本地工作完全不需要考虑远程库的存在，也就是有没有联网都可以正常工作，而SVN在没有联网的时候是拒绝干活的！当有网络的时候，再把本地提交推送一下就完成了同步，真是太方便了！

## `git clone`从远程库克隆

用命令`git clone`克隆一个本地库：

```
$ git clone git@github.com:michaelliao/gitskills.git
Cloning into 'gitskills'...
remote: Counting objects: 3, done.
remote: Total 3 (delta 0), reused 0 (delta 0), pack-reused 3
Receiving objects: 100% (3/3), done.
```

注意把Git库的地址换成你自己的，然后进入`gitskills`目录看看，已经有`README.md`文件了：

```
$ cd gitskills
$ ls
README.md
```

# Bug修复



[push origin 失败](https://www.jianshu.com/p/c3aac5024877)：改成ssh链接，或者关闭代理



